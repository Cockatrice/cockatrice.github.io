<!-- HTML header for doxygen 1.14.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta content="text/xhtml;charset=UTF-8" http-equiv="Content-Type"/>
    <meta content="IE=11" http-equiv="X-UA-Compatible"/>
    <meta content="Doxygen 1.14.0" name="generator"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <title>Cockatrice: Loading Card Pictures</title>
    <link href="../../cockatrice.png" rel="icon" type="image/x-icon"/>
    <link href="../../tabs.css" rel="stylesheet" type="text/css"/>
    <script src="../../jquery.js" type="text/javascript"></script>
    <script src="../../dynsections.js" type="text/javascript"></script>
    <script src="../../clipboard.js" type="text/javascript"></script>
    <link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
    <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
    <link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="../../doxygen_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
        <div id="titlearea">
            <table cellpadding="0" cellspacing="0">
                <tbody>
                <tr id="projectrow">
                    <td id="projectlogo"><img  alt="Logo" src="../../cockatrice.png"/></td>
                    <td id="projectalign">
                        <div id="projectname">Cockatrice<span id="projectnumber">&#160;master</span>
                        </div>
                        <div id="projectbrief">A cross-platform virtual tabletop for multiplayer card games</div>
                    </td>
                    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
</td>
                </tr>
                </tbody>
            </table>
        </div>
        <!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('d9/d1c/loading_card_pictures.html','../../',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Loading Card Pictures </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Pictures associated with <a class="el" href="../../dd/dd2/classCardInfo.html" title="Represents a card and its associated metadata, properties, and relationships.">CardInfo</a>s are retrieved either from on-disk or the network through the <a class="el" href="../../d2/d5d/classCardPictureLoader.html" title="Singleton class to manage card image loading and caching. Provides functionality to asynchronously lo...">CardPictureLoader</a>.</p>
<p>In most cases, you don't need to concern yourself with the internals of <a class="el" href="../../d2/d5d/classCardPictureLoader.html" title="Singleton class to manage card image loading and caching. Provides functionality to asynchronously lo...">CardPictureLoader</a>.</p>
<p>Simply using one of the ways described in <a class="el" href="../../dc/d8a/displaying_cards.html">Displaying Cards</a> is enough to automatically queue a request to the <a class="el" href="../../d2/d5d/classCardPictureLoader.html" title="Singleton class to manage card image loading and caching. Provides functionality to asynchronously lo...">CardPictureLoader</a> when the chosen widget is shown, emitting signals to refresh the widget when the request is finished.</p>
<h1 class="doxsection"><a class="anchor" id="how-requests-are-triggered"></a>
How requests are triggered</h1>
<p><a class="el" href="../../d2/d5d/classCardPictureLoader.html#a12e978377a488933d2aa641d47e08eef" title="Retrieve a card pixmap, either from cache or enqueued for loading.">CardPictureLoader::getPixmap()</a> is called exactly two times in the code base, in <a class="el" href="../../dd/dd2/classCardInfoPictureWidget.html#aa6f08c35516c35eab39efd6ffbbe1ca2" title="Loads the appropriate pixmap based on the current card info.">CardInfoPictureWidget::loadPixmap()</a>, the base class for all widget based card picture display, and <a class="el" href="../../d4/db9/classAbstractCardItem.html#a7e8e4b1aa9f81492695269e45e9ef731">AbstractCardItem::paintPicture()</a>, the base class for all QGraphicsItem based card picture display. See <a class="el" href="../../dc/d8a/displaying_cards.html">Displaying Cards</a> for more information on the difference between these two display methods.</p>
<p>Because both of these calls are made in the paintEvent() methods of their respective classes, this means that requests are issued as soon as but not before the widget is shown on screen.</p>
<p>It is also possible to "warm up" the cache by issuing card picture load requests to the <a class="el" href="../../d2/d5d/classCardPictureLoader.html" title="Singleton class to manage card image loading and caching. Provides functionality to asynchronously lo...">CardPictureLoader</a> without using a display widget and waiting for it to be shown by calling <a class="el" href="../../d2/d5d/classCardPictureLoader.html#adbe0c9e725e3c98bd9bd86e85a428010" title="Preload a list of cards into the pixmap cache (limited to CACHED_CARD_PER_DECK_MAX).">CardPictureLoader::cacheCardPixmaps()</a> with a list of <a class="el" href="../../df/d4e/classExactCard.html" title="Represents a specific card instance, defined by its CardInfo and a particular printing.">ExactCard</a>s.</p>
<h1 class="doxsection"><a class="anchor" id="the-qpixmapcache-and-qnetworkdiskcache"></a>
The QPixmapCache and QNetworkDiskCache</h1>
<p>Cockatrice uses the QPixmapCache from the Qt GUI module to store card pictures in-memory and the QNetworkDiskCache from the Qt Network module to cache network requests for card pictures on-disk.</p>
<p>What this means is that the <a class="el" href="../../d2/d5d/classCardPictureLoader.html" title="Singleton class to manage card image loading and caching. Provides functionality to asynchronously lo...">CardPictureLoader</a> will first attempt to look up a card in the QPixmapCache according to the <a class="el" href="../../df/d4e/classExactCard.html#a1ed6121dc01e43a0d7004ef568e07a42" title="Generates a stable cache key for pixmap caching.">ExactCard::getPixmapCacheKey()</a> method of an <a class="el" href="../../df/d4e/classExactCard.html" title="Represents a specific card instance, defined by its CardInfo and a particular printing.">ExactCard</a> object. If it does not find it in the in-memory cache, it will issue a load request, which will first look for local images on-disk and then consult the QNetworkDiskCache and if found, use the stored binary data from the network cache to populate the in-memory pixmap cache under the card's cache key. If it is not found, it will then proceed with issuing a network request.</p>
<p>The size of both of these caches can be configured by the user in the "Card Sources" settings page.</p>
<h1 class="doxsection"><a class="anchor" id="pixmapcachekeys-and-providerids"></a>
PixmapCacheKeys and ProviderIDs</h1>
<p>TODO</p>
<h1 class="doxsection"><a class="anchor" id="the-redirect-cache"></a>
The Redirect Cache</h1>
<p>TODO</p>
<h1 class="doxsection"><a class="anchor" id="local-image-loading"></a>
Local Image Loading</h1>
<p>TODO</p>
<h1 class="doxsection"><a class="anchor" id="url-generation-and-resolution"></a>
URL Generation and Resolution</h1>
<p>TODO </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- HTML footer for doxygen 1.14.0-->
<!-- start footer part -->
<script src="../../graph_toggle.js"></script>
<div class="navpath" id="nav-path"><!-- id is needed for treeview function! -->
    <ul>
        <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img alt="doxygen"
                                                                                          class="footer"
                                                                                          height="31" src="../../doxygen.svg"
                                                                                          width="104"/></a>
            1.14.0
        </li>
    </ul>
</div>
</body>
</html>
