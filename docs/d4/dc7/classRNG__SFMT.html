<!-- HTML header for doxygen 1.14.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta content="text/xhtml;charset=UTF-8" http-equiv="Content-Type"/>
    <meta content="IE=11" http-equiv="X-UA-Compatible"/>
    <meta content="Doxygen 1.14.0" name="generator"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <title>Cockatrice: RNG_SFMT Class Reference</title>
    <link href="../../cockatrice.png" rel="icon" type="image/x-icon"/>
    <link href="../../tabs.css" rel="stylesheet" type="text/css"/>
    <script src="../../jquery.js" type="text/javascript"></script>
    <script src="../../dynsections.js" type="text/javascript"></script>
    <script src="../../clipboard.js" type="text/javascript"></script>
    <link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
    <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
    <link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="../../doxygen_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
        <div id="titlearea">
            <table cellpadding="0" cellspacing="0">
                <tbody>
                <tr id="projectrow">
                    <td id="projectlogo"><img  alt="Logo" src="../../cockatrice.png"/></td>
                    <td id="projectalign">
                        <div id="projectname">Cockatrice<span id="projectnumber">&#160;master</span>
                        </div>
                        <div id="projectbrief">A cross-platform virtual tabletop for multiplayer card games</div>
                    </td>
                    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
</td>
                </tr>
                </tbody>
            </table>
        </div>
        <!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('d4/dc7/classRNG__SFMT.html','../../','d8/d18/classRNG__SFMT-members'); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">RNG_SFMT Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../d3/dfe/rng__sfmt_8h_source.html">rng_sfmt.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for RNG_SFMT:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="../../d2/d95/classRNG__SFMT__inherit__graph.svg" width="123" height="183"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for RNG_SFMT:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="../../d0/d37/classRNG__SFMT__coll__graph.svg" width="226" height="228"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-methods" class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8faef97fce313ea928dbfa3bde61f604" id="r_a8faef97fce313ea928dbfa3bde61f604"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8faef97fce313ea928dbfa3bde61f604">RNG_SFMT</a> (QObject *parent=nullptr)</td></tr>
<tr class="memitem:ab6c0ec03ba719d6bf11a857c0cbafa8e" id="r_ab6c0ec03ba719d6bf11a857c0cbafa8e"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab6c0ec03ba719d6bf11a857c0cbafa8e">rand</a> (int min, int max) override</td></tr>
<tr class="inherit_header pub_methods_classRNG__Abstract"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_methods_classRNG__Abstract')"><span class="dynarrow"><span class="arrowhead closed"></span></span>Public Member Functions inherited from <a class="el" href="../../de/dba/classRNG__Abstract.html">RNG_Abstract</a></td></tr>
<tr class="memitem:ad4e5a284460861357acc3c5f83afa814 inherit pub_methods_classRNG__Abstract" id="r_ad4e5a284460861357acc3c5f83afa814"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dba/classRNG__Abstract.html#ad4e5a284460861357acc3c5f83afa814">RNG_Abstract</a> (QObject *parent=nullptr)</td></tr>
<tr class="memitem:a33135e7af3865f772b3ed5528da88b6f inherit pub_methods_classRNG__Abstract" id="r_a33135e7af3865f772b3ed5528da88b6f"><td class="memItemLeft" align="right" valign="top">QVector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dba/classRNG__Abstract.html#a33135e7af3865f772b3ed5528da88b6f">makeNumbersVector</a> (int n, int min, int max)</td></tr>
<tr class="memitem:aa06011945373c4bfe8b7914f479f68c4 inherit pub_methods_classRNG__Abstract" id="r_aa06011945373c4bfe8b7914f479f68c4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dba/classRNG__Abstract.html#aa06011945373c4bfe8b7914f479f68c4">testRandom</a> (const QVector&lt; int &gt; &amp;numbers) const</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pri-methods" class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:aa9fada998fa917ae2c3c7520e3210740" id="r_aa9fada998fa917ae2c3c7520e3210740"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa9fada998fa917ae2c3c7520e3210740">cdf</a> (unsigned int min, unsigned int max)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pri-attribs" class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a13d907618ec9870f0fbcf47392bae40c" id="r_a13d907618ec9870f0fbcf47392bae40c"><td class="memItemLeft" align="right" valign="top">QMutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a13d907618ec9870f0fbcf47392bae40c">mutex</a></td></tr>
<tr class="memitem:a694f37eabdc7c647603a04c54fe49d07" id="r_a694f37eabdc7c647603a04c54fe49d07"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/de7/SFMT_8h.html#a786e4a6ba82d3cb2f62241d6351d973f">sfmt_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a694f37eabdc7c647603a04c54fe49d07">sfmt</a></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class encapsulates a state of the art PRNG and can be used to return uniformly distributed integer random numbers from a range [min, max]. Though technically possible, min must be &gt;= 0 and max should always be &gt; 0. If max &lt; 0 and min == 0 it is assumed that <a class="el" href="#ab6c0ec03ba719d6bf11a857c0cbafa8e">rand()</a> % -max is wanted and the result will be -rand(0, -max). This is the only exception to the rule that !(min &gt; max) and is actually unused in Cockatrice.</p>
<p>Technical details: The RNG uses the SIMD-oriented Fast Mersenne Twister code v1.4.1 from <a href="http://www.math.sci.hiroshima-u.ac.jp/~%20m-mat/MT/SFMT/index.html">http://www.math.sci.hiroshima-u.ac.jp/~%20m-mat/MT/SFMT/index.html</a> The SFMT RNG creates unsigned int 64bit pseudo random numbers.</p>
<p>These are mapped to values from the interval [min, max] without bias by using Knuth's "Algorithm S (Selection sampling technique)" from "The Art of Computer Programming 3rd
Edition Volume 2 / Seminumerical Algorithms". </p>
</div><a name="doc-constructors" id="doc-constructors"></a><h2 id="header-doc-constructors" class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a8faef97fce313ea928dbfa3bde61f604" name="a8faef97fce313ea928dbfa3bde61f604"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8faef97fce313ea928dbfa3bde61f604">&#9670;&#160;</a></span>RNG_SFMT()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">RNG_SFMT::RNG_SFMT </td>
          <td>(</td>
          <td class="paramtype">QObject *</td>          <td class="paramname"><span class="paramname"><em>parent</em></span><span class="paramdefsep"> = </span><span class="paramdefval">nullptr</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel explicit">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="../../d4/dc7/classRNG__SFMT_a8faef97fce313ea928dbfa3bde61f604_cgraph.svg" width="443" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Member Function Documentation</h2>
<a id="aa9fada998fa917ae2c3c7520e3210740" name="aa9fada998fa917ae2c3c7520e3210740"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9fada998fa917ae2c3c7520e3210740">&#9670;&#160;</a></span>cdf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int RNG_SFMT::cdf </td>
          <td>(</td>
          <td class="paramtype">unsigned int</td>          <td class="paramname"><span class="paramname"><em>min</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int</td>          <td class="paramname"><span class="paramname"><em>max</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Much thought went into this, please read this comment before you modify the code. Let SFMT() be an alias for <a class="el" href="../../d4/de7/SFMT_8h.html#ae99df9ac1b48be1370492d448504b717">sfmt_genrand_uint64()</a> aka SFMT's <a class="el" href="#ab6c0ec03ba719d6bf11a857c0cbafa8e">rand()</a> function.</p>
<p>SMFT() returns a uniformly distributed pseudorandom number from 0 to UINT64_MAX. As SFMT() operates on a limited integer range, it is a <em>discrete</em> function.</p>
<p>We want a random number from a given interval [min, max] though, so we need to implement the (discrete) cumulative distribution function SFMT(min, max), which returns a random number X from [min, max].</p>
<p>This CDF is by formal definition: SFMT(X; min, max) = (floor(X) - min + 1) / (max - min + 1)</p>
<p>To get out the random variable, solve for X: floor(X) = SFMT(X; min, max) * (max - min + 1) + min - 1 So this is, what rand(min, max) should look like. Problem: SFMT(X; min, max) * (max - min + 1) could produce an integer overflow, so it is not safe.</p>
<p>One solution is to divide the universe into buckets of equal size depending on the range [min, max] and assign X to the bucket that contains the number generated by SFMT(). This equals to modulo computation and is not satisfying: If the buckets don't divide the universe equally, because the bucket size is not a divisor of 2, there will be a range in the universe that is biased because one bucket is too small thus will be chosen less equally!</p>
<p>This is solved by rejection sampling: As SFMT() is assumed to be unbiased, we are allowed to ignore those random numbers from SFMT() that would force us to have an unequal bucket and generate new random numbers until one number fits into one of the other buckets. This can be compared to an ideal six sided die that is rolled until only sides 1-5 show up, while 6 represents something that you don't want. So you basically roll a five sided die.</p>
<p>Note: If you replace the SFMT RNG with some other <a class="el" href="#ab6c0ec03ba719d6bf11a857c0cbafa8e">rand()</a> function in the future, then you <em>need</em> to change the UINT64_MAX constant to the largest possible random number which can be created by the new <a class="el" href="#ab6c0ec03ba719d6bf11a857c0cbafa8e">rand()</a> function. This value is often defined in a RAND_MAX constant. Otherwise you will probably skew the outcome of the <a class="el" href="#ab6c0ec03ba719d6bf11a857c0cbafa8e">rand()</a> method or worsen the performance of the application. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="../../d4/dc7/classRNG__SFMT_aa9fada998fa917ae2c3c7520e3210740_cgraph.svg" width="531" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="../../d4/dc7/classRNG__SFMT_aa9fada998fa917ae2c3c7520e3210740_icgraph.svg" width="311" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ab6c0ec03ba719d6bf11a857c0cbafa8e" name="ab6c0ec03ba719d6bf11a857c0cbafa8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6c0ec03ba719d6bf11a857c0cbafa8e">&#9670;&#160;</a></span>rand()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int RNG_SFMT::rand </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>min</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>max</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel override">override</span><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This method is the <a class="el" href="#ab6c0ec03ba719d6bf11a857c0cbafa8e">rand()</a> equivalent which calls the cdf with proper bounds.</p>
<p>It is possible to generate random numbers from [-min, +/-max] though the RNG uses unsigned numbers only, so this wrapper handles some special cases for min and max.</p>
<p>It is only necessary that the upper bound is larger or equal to the lower bound - with the exception that someone wants something like <a class="el" href="#ab6c0ec03ba719d6bf11a857c0cbafa8e">rand()</a> % -foo. </p>

<p>Implements <a class="el" href="../../de/dba/classRNG__Abstract.html#ae178b12153e702f8250c343636a2db37">RNG_Abstract</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" loading="lazy" frameborder="0" src="../../d4/dc7/classRNG__SFMT_ab6c0ec03ba719d6bf11a857c0cbafa8e_cgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="../../d4/dc7/classRNG__SFMT_ab6c0ec03ba719d6bf11a857c0cbafa8e_icgraph.svg" width="311" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a name="doc-variable-members" id="doc-variable-members"></a><h2 id="header-doc-variable-members" class="groupheader">Member Data Documentation</h2>
<a id="a13d907618ec9870f0fbcf47392bae40c" name="a13d907618ec9870f0fbcf47392bae40c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13d907618ec9870f0fbcf47392bae40c">&#9670;&#160;</a></span>mutex</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QMutex RNG_SFMT::mutex</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a694f37eabdc7c647603a04c54fe49d07" name="a694f37eabdc7c647603a04c54fe49d07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a694f37eabdc7c647603a04c54fe49d07">&#9670;&#160;</a></span>sfmt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/de7/SFMT_8h.html#a786e4a6ba82d3cb2f62241d6351d973f">sfmt_t</a> RNG_SFMT::sfmt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>libcockatrice_rng/libcockatrice/rng/<a class="el" href="../../d3/dfe/rng__sfmt_8h_source.html">rng_sfmt.h</a></li>
<li>libcockatrice_rng/libcockatrice/rng/<a class="el" href="../../d6/d7d/rng__sfmt_8cpp.html">rng_sfmt.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- HTML footer for doxygen 1.14.0-->
<!-- start footer part -->
<script src="../../graph_toggle.js"></script>
<div class="navpath" id="nav-path"><!-- id is needed for treeview function! -->
    <ul>
        <li class="navelem"><a href="../../d4/dc7/classRNG__SFMT.html">RNG_SFMT</a></li>
        <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img alt="doxygen"
                                                                                          class="footer"
                                                                                          height="31" src="../../doxygen.svg"
                                                                                          width="104"/></a>
            1.14.0
        </li>
    </ul>
</div>
</body>
</html>
